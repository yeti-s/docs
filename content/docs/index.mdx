---
title: 'Project Document'
description: 'Introduction of docs projects'
---

# 초기 구현

그간 다양한 프로젝트를 진행하기에 급해 기록을 남기지 않았더라구요.
지금부터라도 프로젝트 진행하며 기획, 개발 과정, 레거시 등을 기록하기 위해 Docs를 제작해봤어요.

## 프레임워크 선정
넓게 보아 Potree를 통해 웹에서 시각화된 Point Cloud 데이터를 띄우기 위해 React를 이용해서 처음부터 제작을 하려고 했어요.
그런데 배보다 배꼽이 더 큰 상황이 발생할 것 같아 다른 방법을 찾아보니 .md .mdx파일 만으로 간단하게 콘텐츠를 추가할 수 있는 정적 페이지 생성 프레임워크가 있네요.
Jekyll, Hexo, Hugo, Gatsby 등 여러가지 종류가 있었는데, 그 중 Gatsby가 React 기반이라고 하여 선정했습니다.

## 템플릿
처음부터 만들기엔 시간이 오래 걸릴 것 같아 [Gatsby Theme Document](https://github.com/codebushi/gatsby-theme-document-example) 테마를 사용했어요.

## 개발과 배포
```sh
$ npm run develop
```
위 명령어를 이용하여 [http://localhost:8000](http://localhost:8000)에서 수정이 발생할 시 Hot Reload 형식으로 개발을 진행할 수 있습니다.

또 Github에 배포를 진행하기 위해 gh-pages 패키지를 사용했어요.
```sh
$ npm run deploy
```
위 명령어를 입력하여 Github gh-pages 브랜치로 자동으로 배포가 됩니다. [https://yeti-s.github.io](https://yeti-s.github.io)  
이때 repository 이름을 '[github 계정].github.io'로 만들어야 해당 url로 입력하였을 때 바로 접속할 수 있더라구요.

## 콘텐츠 작성 규칙
콘텐츠는 content 폴더에 .mdx 파일 형식으로 작성합니다.
이 때 파일의 가장 첫 부분은 아래와 같은 형식으로 구성되어야 합니다!
```
---
title: 'Hello'
description: 'Description of this content'
---
```
content를 추가하기 위해 폴더를 생성하고 index.mdx 파일을 생성하여 내용을 작성합니다.  
해당 폴더내에 추가로 {sub_file}.mdx파일을 생성할 경우 하나의 카테고리로 묶여 좌측 사이드바에 표시되도록 설정 하였어요.  
사용되는 정적파일의 경우 해당 폴더에 assets/{file_name} 폴더를 생성하고 00 ~ 99 까지 넘버링으로 저장합시다!
```
|-- content
    |-- index.mdx
    |-- docs
    |   |-- index.mdx
    |   |-- sub_file1.mdx
    |   |-- assets
    |       |-- index
    |           |-- 00.png
    |           |-- 01.png
    |       |-- sub_file1
    |           |-- 00.png
    |-- cv
    |   |-- index.mdx
    |   |-- sub_file2.mdx
    |   |-- assets
    |       |-- index
    |           |-- 00.png
    |       |-- sub_file2
    |           |-- 00.png
```

# 추가 개발

## 수식 추가
공부 내용을 정리하다 보면 수식을 사용할 일이 많더라구요.
그때마다 사진으로 넣기에는 너무 비효율적이에요.
그래서 수식을 표현할 수 있는 katex라는 패키지를 추가 했습니다.
```sh
$ npm install i remark-math@3.0.1 rehype-katex@5.0.0 katex --force
```
gatsby-theme-document에서는 dependency로 .mdx파일을 html로 변환하는 gatsby-plugin-mdx를 가지고 있습니다.
gatsby-plugin-mdx는 내부적으로 remark version 10을 사용하고 있는데 remark-math vesion 4부터는 remark version 13을 필요로 하기 떄문에 version 3으로 설치해야 합니다!

이제 gatsby-theme-document 패키지 내부 gatsby-config.js에 plugin으로 추가를 해주죠.
```js
// gatsby-config.js
module.exports = {
    ...
    plugins: [
        {
            resolve: 'gatsby-plugin-mdx',
            options: {
                ...
                remarkPlugins: [require('remark-math')],
                rehypePlugins: [require('rehype-katex')]
            }
        }
    ]
}
```
마지막으로 css를 template에 import 해주면 완성!
```js
//docs.js
import 'katex/dist/katex.min.css'
```

아래와 같은 방식으로 수식을 표현할 수 있어요.
```
$$
S_n = \frac{n(2a + (n-1)d)}{2}
$$
```
$$
S_n = \frac{n(2a + (n-1)d)}{2}
$$

잘 모르겠으면 [Katex Editor](https://editor.codecogs.com/) 사이트를 참고해서 작성하면 됩니다.

## 프로젝트 구조 변경
위 수식 추가 작업을 진행하며 gatsby-theme-document 패키지 내부를 수정하였으나 이는 다른 환경에서 Git clone 하면 해당 부분을 다시 수정해야 하는 번거로움이 있어요.
그래서 Git에 변경사항이 저장되고 또 theme를 수정할 수 있도록 해당 패키지를 root directory로 이식하는 작업을 진행하려 합니다.

뭐 크게 어려운 작업은 없고 gatsby-config.js, package.json 하나로 합쳐주고 기타 source file들을 root directory에 옮겨오기만 하면 되네요.
패키지의 src를 변경할 수 있게 되어서 간단하게 본문이 가운데 정렬이 되도록 수정해 보았어요.
```js
// src/components/Layout.js
...
const SiteContentWrapper = styled.div`
  flex-grow: 1;
  min-width: 20rem;
  display: flex;
  justify-content: center
`;
...
```

![align center](assets/index/00.PNG)

## 전역 상태 설정
기본 테마로 채택하였던 gatsby-theme-document는 좌측 사이드바의 콘텐츠에서 하위 목록을 모두 나열하는 상태를 기본으로 하고 있네요.
콘텐츠가 추가되면 내용이 너무 많아 난잡할 수 있다고 생각을 했습니다.
기본을 가장 상위 목록만 보이는 것으로 하고 더보기를 눌러야 하위 컨텐츠를 보여주는 방식으로 변경해보죠!

이전에 사용해본 경험이 있는 상태관리 패키지 redux를 사용하려 했엇는데 useContext라는 hook을 이용해서 할 수 있다고 하더라구요.
굳이 의존성을 추가할 필요 없이 useContext를 사용해서 구현을 해볼게요.

context api는 React 16.3 버전부터 제공되었다고 하네요.
기존 redux와 마찬가지로 hook을 통해 렌더링을 하는 방식으로 사용할 수 있다고 해요.
이미 gatsby-theme-document는 좌측 사이드바에 대한 더보기 구현을 useContext로 구성하고 있더라구요.
이를 반대로 수정만 하여 기본 상태를 닫힌 상태로 만들 수 있었습니다.

뭐 여담으로 context api에 대해 잠깐 찾아봤어요.
context api는 전역 상태가 변경됨에 따라 useContext를 사용하는 모든 컴포넌트가 다시 렌더링된다고 합니다.
뭐 해당 프로젝트는 규모가 작어서 문제가 없지만 '큰 규모로 전역 상태관리를 할 경우 아직까진 redux를 써야하지 않을까?' 생각을 합니다.

# 2.0 업데이트를

기존 Gatsby v2와 javascript로 이루어진 프로젝트를 확장성을 위해 Gastby v5와 typescript로 변경하려 합니다.

## Gatsby5


## 남은 작업
* atomic design으로 디자인 패턴 변경
* 일부 css 변경
* SEO 추가
* Code 추가

