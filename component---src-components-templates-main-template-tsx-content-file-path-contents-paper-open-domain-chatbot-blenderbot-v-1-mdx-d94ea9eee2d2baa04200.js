"use strict";(self.webpackChunkyeti_docs=self.webpackChunkyeti_docs||[]).push([[509],{3832:function(e,t,a){var m=a(4316),l=(a(7294),a(917));const s=(0,m.Z)("code",{target:"e1h9msy90"})({name:"15yct12",styles:"display:block;width:100%;padding:0.2rem 0.4rem 0rem;color:var(--comment-color)"});t.Z=e=>{let{children:t}=e;return(0,l.tZ)(s,null,t)}},8142:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var m=a(1151),l=a(7294),s=a(3832);function n(e){const t=Object.assign({p:"p",a:"a",br:"br",h1:"h1",code:"code",ul:"ul",li:"li",span:"span",h2:"h2",math:"math",semantics:"semantics",mrow:"mrow",mi:"mi",annotation:"annotation",mo:"mo",mn:"mn",msub:"msub",mtext:"mtext",div:"div",msubsup:"msubsup",msup:"msup",munderover:"munderover",h3:"h3"},(0,m.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(t.p,null,l.createElement(t.a,{href:"https://arxiv.org/pdf/2004.08449.pdf"},"Can You Put it All Together: Evaluating Conversational Agents' Ability to Blend Skills"),l.createElement(t.br),"\n",l.createElement(t.a,{href:"https://arxiv.org/pdf/2004.13637.pdf"},"Recipes for building an open-domain chatbot"),l.createElement(t.br),"\n",l.createElement(t.a,{href:"https://arxiv.org/pdf/1905.01969.pdf"},"Poly-encoders: architectures and pre-training strategies for fast and accurate multi-sentence scoring"),l.createElement(t.br),"\n","논문을 바탕으로 작성하였습니다."),"\n",l.createElement(t.p,null,"사람과 같은 대화는 어떻게 정의할 수 있을까요?\r\n논문에서는 사람과 같은 대화를 상대방의 말에 공감할 수 있고, 지식이 필요한 주제에 대해 대화할 수 있고, 개인이 겪은 경험과 성격에 기반한 응답을 만들 수 있어야 합니다.\r\n기존의 각 작업에 대한 여러 모델이 등장하였지만, 이를 모두 다룰 수 있는 open-domain conversation을 위해서는 추가적인 데이터가 필요하다고 생각하였어요."),"\n",l.createElement(t.h1,{id:"bst"},"BST"),"\n",l.createElement(t.p,null,l.createElement(t.code,null,"BST(Blended Skill talk)"),"는 위 모든 작업을 번갈아가며 수행할 수 있도록 여러 데이터를 이용하여 구성했습니다.\r\n논문에서는 크게 3가지 dataset을 활용하여 ",l.createElement(t.code,null,"BST"),"를 만들었어요."),"\n",l.createElement(t.ul,null,"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"ConvAI2",l.createElement(t.br),"\n",l.createElement(t.code,null,"ConvAI2"),"는 각 발화자가 서로에 대해 알아가기 위해 자신의 페르소나에 의거해 대화를 이어나가도록 만들어진 데이터입니다.\r\n발화자는 상대방의 페르소나를 알아내기 위해 질문과 답을 주고 받으며 대화를 이어나가는 것이죠.\r\n이러한 대화 이력을 통해 bot에게 주어진 페르소나와 일관성 있는 답변을 생성하는 능력을 기를 수 있습니다."),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"ED(Empathetic Dialogues)",l.createElement(t.br),"\n",l.createElement(t.code,null,"ED"),"는 감정적인 대화로 구성된 데이터입니다.\r\n한 발화자가 개인적인 상황에 대해 묘사하면, 상대 발화자가 이에 공감을 보여주는 대화로 구성되어있죠.\r\n공감을 보여주는 발화자의 역할을 모델이 수행하도록 학습을 진행하여 bot이 공감적인 응답을 생성하도록 만들 수 있습니다."),"\n"),"\n",l.createElement(t.li,null,"\n",l.createElement(t.p,null,"WoW(Wizard of Wikipedia)",l.createElement(t.br),"\n",l.createElement(t.code,null,"WoW"),"는 주제에 대한 깊이있는 지식을 요하는 대화를 기반으로 구성하였습니다.\r\n무작위로 선택된 주제에 대해 retrieval system을 통해 선별된 Wikipedia 주제를 활용하여 대화를 진행하는 방식입니다."),"\n"),"\n"),"\n",l.createElement(t.p,null,"논문에서는 위 3가지 데이터를 활용하여 각 작업을 모두 수행할 수 있는 응답을 만들어내는 모델을 만드려고 합니다.\r\n이를 위해서 응답을 생성할 때 상황에 맞춰 위 데이터를 선택적으로 사용하는 데이터를 만든 것이 바로 ",l.createElement(t.code,null,"BST"),"입니다."),"\n",l.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 704px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/f68faa12ca77c52881aa3cc222984c10/2c95d/00.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 72.72727272727273%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACkUlEQVR42m1UCY6bQBDk/y9b7UpxYmPOwdyHjQEDvgFXuhuTSJuMVGIGhqK6qwZto+sIbBv1ZoNyvUZhGGi7FmEYYrvVoes+TLOF45zRNBfcbldcr//icrng+XxCM4jAIULPsuA7DgLPQ9u2SNMUjutgtwsQxwX2+5pevGMcBwzD/zFNE7TPjw+sVj/w+fWF1c8VDNOUNRM+nwN4TNMoGMcFM8H4xkL2er2gmYZNJRkEk8rTqcytlOoHPpIkRhwR4hgRteB0OlHZDeq6RnNqaF7LvDyWeDweM6FlMIGBKIrQ9z0a2tD3HU7vF4/H40xA667rcD736Lsel2buGWMpeeSSd56PiBT4vi9GcKmMmNQlaSLqsjxHlmUyT7MU5aFEc2jECAYLYUgPXVvBdmwEYQClPDJhB+W5UI5CpGJRWFUVDocDyrIUtaK8Osp6X+xRlZWoF5dd24WrXCHyPIXADxDuSGmSIs9yUpShKApRGFBfc1Kb0/rK6jgu/QXDbcQytIgJqH9MGJJKJsqiDIdyVjQrO6BIC3RFj4GcZ5cXx7lMHq+F0NQtyZtJebQpj34QSAsc3UGoIlKTiaoyLnHuz7hdbrif7ximAY/nQ8x4vfBXoUWEtsOEJizLJlgyZ7jUR9fldnhimqLWKEsh9mM0YYPpMeH70FzaEEaBOKyUkiu/nPgJ6qqW+LApVV3NVzaDclflR+nflY7inU7Qa5xlamnKkUgpxIkEWa4cm3gONH8gfj9L3/s4s0u8+HkSJeI2k2tcok1YrzfY0A+C+8gnhU8Ol71areS+xWvCZrOWPX/uWSa2dDh+0Y+lbTtoS5j5qyEZkqVzgFkJmyHXIp/DTnt4vd/v5zRQrPh9TgP/cdj13/qtW1f7ayz0AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="00"\n        title=""\n        src="/static/f68faa12ca77c52881aa3cc222984c10/5ebd7/00.png"\n        srcset="/static/f68faa12ca77c52881aa3cc222984c10/06437/00.png 176w,\n/static/f68faa12ca77c52881aa3cc222984c10/ba1c3/00.png 352w,\n/static/f68faa12ca77c52881aa3cc222984c10/5ebd7/00.png 704w,\n/static/f68faa12ca77c52881aa3cc222984c10/fd84e/00.png 1056w,\n/static/f68faa12ca77c52881aa3cc222984c10/2c95d/00.png 1099w"\n        sizes="(max-width: 704px) 100vw, 704px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",l.createElement(t.p,null,"데이터를 구성하기 위해 두 발화자는 ",l.createElement(t.code,null,"ConvAI2"),"로 부터 임의로 선택된 페르소나를 할당받습니다.\r\n또 대화는 ",l.createElement(t.code,null,"ConvAI2"),", ",l.createElement(t.code,null,"ED"),", ",l.createElement(t.code,null,"WoW")," 데이터중 하나의 대화로부터 시작됩니다.\r\n이때 한 가지 스킬(공감, 지식, 페르소나)만을 사용하여 대화하는 것을 막기 위해 각 발화자를 guided speaker, unguided speaker로 나눕니다.\r\n대화는 unguided speaker 차례부터 시작되며, guided speaker의 차례가 되면 각 모델을 통해 각각의 스킬에 해당하는 최적의 응답을 제시합니다.\r\nGuided speaker는 제시된 응답을 기반으로 혹은 이를 무시하고 응답을 생성하도록 합니다."),"\n",l.createElement(t.h1,{id:"poly-encoder"},"Poly-encoder"),"\n",l.createElement(t.p,null,"기존에 두 문장을 비교하기 위해 fully self-attention을 사용하는 방식은 성능에 비해 큰 비용을 요구합니다.\r\n",l.createElement(t.code,null,"Poly-encoder"),"는 ",l.createElement(t.code,null,"Bi-encoder"),"와 ",l.createElement(t.code,null,"Cross-encoder"),"를 적절하게 사용하여 낮은 비용으로 추론을 하도록 구성된 모델입니다."),"\n",l.createElement(t.h1,{id:"blenderbot"},"BlenderBot"),"\n",l.createElement(t.p,null,"이제 앞서 다루었던 3종류의 데이터와 이를 통해 구성한 ",l.createElement(t.code,null,"BST"),", 총 4가지 데이터를 활용하여 사람과 같은 대화를 생성하는 모델을 만들려고 합니다.\r\n논문에서 모델은 모두 transformer를 사용하는 3가지 구조로 구성되어 있습니다."),"\n",l.createElement(t.h2,{id:"retriever"},"Retriever"),"\n",l.createElement(t.p,null,l.createElement(t.code,null,"Retriever")," 모듈은 context(dialogue history)를 입력으로 받을 떄 다음 발화 후보에서 가장 높은 점수를 가지는 발화를 선택하는 작업을 진행합니다.\r\n학습 데이터의 모든 응답이 발화 후보가 되며, 여기서 가장 높은 점수를 받은 응답을 선택하는 것이죠.\r\n입력 context의 응답으로 올 수 있는 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"N")),l.createElement(t.annotation,{encoding:"application/x-tex"},"N")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6833em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"))))),"개의 후보를 선정하는 방법으로 ",l.createElement(t.code,null,"FAISS"),"를 사용하였습니다."),"\n",l.createElement(t.p,null,"논문에서 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"N"),l.createElement(t.mo,null,"="),l.createElement(t.mn,null,"64")),l.createElement(t.annotation,{encoding:"application/x-tex"},"N=64")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6833em"}}),l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}}),l.createElement(t.span,{className:"mrel"},"="),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}})),l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6444em"}}),l.createElement(t.span,{className:"mord"},"64"))))),"인 ",l.createElement(t.code,null,"poly-encoder"),"를 이용하여 이를 구현하였습니다.\r\nCross-entrophy loss를 이용하여 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"c"),l.createElement(t.mi,null,"a"),l.createElement(t.mi,null,"n"),l.createElement(t.msub,null,l.createElement(t.mi,null,"d"),l.createElement(t.mn,null,"1")))),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.mo,null,"⋯"),l.createElement(t.mtext,null," "),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"c"),l.createElement(t.mi,null,"a"),l.createElement(t.mi,null,"n"),l.createElement(t.msub,null,l.createElement(t.mi,null,"d"),l.createElement(t.mi,null,"n"))))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_{cand_1}, \\cdots, y_{cand_n}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6807em",verticalAlign:"-0.2501em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3361em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"c"),l.createElement(t.span,{className:"mord mathnormal mtight"},"an"),l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"d"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3173em"}},l.createElement(t.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.5em"}}),l.createElement(t.span,{className:"sizing reset-size3 size1 mtight"},l.createElement(t.span,{className:"mord mtight"},"1")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.143em"}},l.createElement(t.span)))))))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2501em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"minner"},"⋯"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3361em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"c"),l.createElement(t.span,{className:"mord mathnormal mtight"},"an"),l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"d"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.1645em"}},l.createElement(t.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.5em"}}),l.createElement(t.span,{className:"sizing reset-size3 size1 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"n")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.143em"}},l.createElement(t.span)))))))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2501em"}},l.createElement(t.span))))))))))," 중에서 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"c"),l.createElement(t.mi,null,"a"),l.createElement(t.mi,null,"n"),l.createElement(t.msub,null,l.createElement(t.mi,null,"d"),l.createElement(t.mn,null,"1"))))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_{cand_1}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6807em",verticalAlign:"-0.2501em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3361em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"c"),l.createElement(t.span,{className:"mord mathnormal mtight"},"an"),l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"d"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3173em"}},l.createElement(t.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.5em"}}),l.createElement(t.span,{className:"sizing reset-size3 size1 mtight"},l.createElement(t.span,{className:"mord mtight"},"1")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.143em"}},l.createElement(t.span)))))))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2501em"}},l.createElement(t.span))))))))))," 을 제외한 나머지는 negative sampling 방식으로 학습을 진행했습니다.\r\n이때 batch의 각 element를 gold candidate로 두어 하나의 batch 안에서 발화 후보들을 한번만 embedding 하는 방식으로 빠르게 학습할 수 있었어요."),"\n",l.createElement(t.h2,{id:"generator"},"Generator"),"\n",l.createElement(t.p,null,l.createElement(t.code,null,"Generator")," 모듈은 context와 ",l.createElement(t.code,null,"Retriever")," 모듈을 통해 선택된 발화 후보(best candidate)를 이용하여 응답을 생성하는 작업을 진행합니다.\r\nContext와 best candidate를 [sep] 토큰으로 구분하여 만든 토큰들을 입력으로 주는 것이죠."),"\n",l.createElement(t.p,null,"논문에서 Seq2Seq 모델을 이용하여 이를 구현하였습니다.\r\n특히 2 encoder layer와 24 encoder layer로 구성된 2.7B 파라미터의 모델과 같이 적은 encoder와 많은 decoder로 이루어졌어요.\r\n",l.createElement(t.code,null,"MLE(Maximum Likelihood Estimation)")," 접근으로 모델을 학습시킵니다."),"\n",l.createElement(t.div,{className:"math math-display"},l.createElement(t.span,{className:"katex-display"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msubsup,null,l.createElement(t.mi,null,"L"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"M"),l.createElement(t.mi,null,"L"),l.createElement(t.mi,null,"E")),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.msub,null,l.createElement(t.mi,null,"p"),l.createElement(t.mi,null,"θ")),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msup,null,l.createElement(t.mi,null,"x"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msup,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mo,{stretchy:"false"},")"),l.createElement(t.mo,null,"="),l.createElement(t.mo,null,"−"),l.createElement(t.munderover,null,l.createElement(t.mo,null,"∑"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"t"),l.createElement(t.mo,null,"="),l.createElement(t.mn,null,"1")),l.createElement(t.mrow,null,l.createElement(t.mo,{fence:"true"},"∣"),l.createElement(t.msup,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mo,{fence:"true"},"∣"))),l.createElement(t.mi,null,"log"),l.createElement(t.mo,null,"⁡"),l.createElement(t.msub,null,l.createElement(t.mi,null,"p"),l.createElement(t.mi,null,"θ")),l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.msubsup,null,l.createElement(t.mi,null,"y"),l.createElement(t.mi,null,"t"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mi,{mathvariant:"normal"},"∣"),l.createElement(t.msup,null,l.createElement(t.mi,null,"x"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mo,{separator:"true"},","),l.createElement(t.msubsup,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mo,null,"<"),l.createElement(t.mi,null,"t")),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")"))),l.createElement(t.mo,{stretchy:"false"},")")),l.createElement(t.annotation,{encoding:"application/x-tex"},"L_{MLE}^{(i)} (p_\\theta, x^{(i)}, y^{(i)}) = - \\sum_{t=1}^{\\left| y^{(i)} \\right|} \\log p_\\theta (y_t^{(i)} | x^{(i)}, y_{<t}^{(i)})")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.3383em",verticalAlign:"-0.2935em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"L"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.0448em"}},l.createElement(t.span,{style:{top:"-2.4065em",marginLeft:"0em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"M"),l.createElement(t.span,{className:"mord mathnormal mtight"},"L"),l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"}},"E")))),l.createElement(t.span,{style:{top:"-3.2198em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2935em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"p"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3361em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"θ")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"x"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.938em"}},l.createElement(t.span,{style:{top:"-3.113em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.938em"}},l.createElement(t.span,{style:{top:"-3.113em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))))))),l.createElement(t.span,{className:"mclose"},")"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}}),l.createElement(t.span,{className:"mrel"},"="),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.2778em"}})),l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"3.5281em",verticalAlign:"-1.2671em"}}),l.createElement(t.span,{className:"mord"},"−"),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mop op-limits"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"2.261em"}},l.createElement(t.span,{style:{top:"-1.8829em",marginLeft:"0em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3.05em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"t"),l.createElement(t.span,{className:"mrel mtight"},"="),l.createElement(t.span,{className:"mord mtight"},"1")))),l.createElement(t.span,{style:{top:"-3.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3.05em"}}),l.createElement(t.span,null,l.createElement(t.span,{className:"mop op-symbol large-op"},"∑"))),l.createElement(t.span,{style:{top:"-4.5135em",marginLeft:"0em"}},l.createElement(t.span,{className:"pstrut",style:{height:"3.05em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"minner mtight"},l.createElement(t.span,{className:"mopen sizing reset-size3 size6 mtight delimcenter",style:{top:"0.075em"}},l.createElement(t.span,{className:"mtight"},"∣")),l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.9667em"}},l.createElement(t.span,{style:{top:"-2.9667em",marginRight:"0.0714em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.5357em"}}),l.createElement(t.span,{className:"sizing reset-size3 size1 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))))))),l.createElement(t.span,{className:"mclose sizing reset-size3 size6 mtight delimcenter",style:{top:"0.075em"}},l.createElement(t.span,{className:"mtight"},"∣"))))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.2671em"}},l.createElement(t.span))))),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mop"},"lo",l.createElement(t.span,{style:{marginRight:"0.01389em"}},"g")),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"p"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3361em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"θ")))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mopen"},"("),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.0448em"}},l.createElement(t.span,{style:{top:"-2.4542em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"t"))),l.createElement(t.span,{style:{top:"-3.2198em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2458em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mord"},"∣"),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"x"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.938em"}},l.createElement(t.span,{style:{top:"-3.113em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))))))),l.createElement(t.span,{className:"mpunct"},","),l.createElement(t.span,{className:"mspace",style:{marginRight:"0.1667em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.0448em"}},l.createElement(t.span,{style:{top:"-2.4542em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mrel mtight"},"<"),l.createElement(t.span,{className:"mord mathnormal mtight"},"t")))),l.createElement(t.span,{style:{top:"-3.2198em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2731em"}},l.createElement(t.span)))))),l.createElement(t.span,{className:"mclose"},")")))))),"\n",l.createElement(t.p,null,l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msup,null,l.createElement(t.mi,null,"x"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"x^{(i)}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.888em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal"},"x"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.888em"}},l.createElement(t.span,{style:{top:"-3.063em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))))))))))),", ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msup,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y^{(i)}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.0824em",verticalAlign:"-0.1944em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.888em"}},l.createElement(t.span,{style:{top:"-3.063em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))))))))))),", ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msubsup,null,l.createElement(t.mi,null,"y"),l.createElement(t.mi,null,"t"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_t^{(i)}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"1.2906em",verticalAlign:"-0.2458em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"1.0448em"}},l.createElement(t.span,{style:{top:"-2.4542em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"t"))),l.createElement(t.span,{style:{top:"-3.2198em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2458em"}},l.createElement(t.span)))))))))),"는 각각 gold input context, gold next-utterance, ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mo,{stretchy:"false"},"("),l.createElement(t.mi,null,"i"),l.createElement(t.mo,{stretchy:"false"},")")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_{(i)}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.7858em",verticalAlign:"-0.3552em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3448em"}},l.createElement(t.span,{style:{top:"-2.5198em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mopen mtight"},"("),l.createElement(t.span,{className:"mord mathnormal mtight"},"i"),l.createElement(t.span,{className:"mclose mtight"},")"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3552em"}},l.createElement(t.span)))))))))),"의 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.mi,null,"t")),l.createElement(t.annotation,{encoding:"application/x-tex"},"t")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.6151em"}}),l.createElement(t.span,{className:"mord mathnormal"},"t")))))," 번째 토큰입니다."),"\n",l.createElement(s.Z,null,l.createElement(t.p,null,"Retriever 모듈에서 context와 candidate의 cross-attention 연산을 통해 생성된 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"c"),l.createElement(t.mi,null,"t"),l.createElement(t.mi,null,"x"),l.createElement(t.mi,null,"t")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_{ctxt}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2806em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"c"),l.createElement(t.span,{className:"mord mathnormal mtight"},"t"),l.createElement(t.span,{className:"mord mathnormal mtight"},"x"),l.createElement(t.span,{className:"mord mathnormal mtight"},"t"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))))))),"와 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"c"),l.createElement(t.mi,null,"a"),l.createElement(t.mi,null,"n"),l.createElement(t.mi,null,"d")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_{cand}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.3361em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"c"),l.createElement(t.span,{className:"mord mathnormal mtight"},"an"),l.createElement(t.span,{className:"mord mathnormal mtight"},"d"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))))))),"를 dot product 하여 score를 구합니다.\r\n그리고 context와 가장 높은 점수를 얻은 candidate를 tokenize 하여 이를 Decoder 모듈의 입력으로 사용하는 방식이죠.\r\n그런데 왜 이미 context와 candidate의 정보를 모두 이용한 ",l.createElement(t.span,{className:"math math-inline"},l.createElement(t.span,{className:"katex"},l.createElement(t.span,{className:"katex-mathml"},l.createElement(t.math,{xmlns:"http://www.w3.org/1998/Math/MathML"},l.createElement(t.semantics,null,l.createElement(t.mrow,null,l.createElement(t.msub,null,l.createElement(t.mi,null,"y"),l.createElement(t.mrow,null,l.createElement(t.mi,null,"c"),l.createElement(t.mi,null,"t"),l.createElement(t.mi,null,"x"),l.createElement(t.mi,null,"t")))),l.createElement(t.annotation,{encoding:"application/x-tex"},"y_{ctxt}")))),l.createElement(t.span,{className:"katex-html","aria-hidden":"true"},l.createElement(t.span,{className:"base"},l.createElement(t.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),l.createElement(t.span,{className:"mord"},l.createElement(t.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),l.createElement(t.span,{className:"msupsub"},l.createElement(t.span,{className:"vlist-t vlist-t2"},l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.2806em"}},l.createElement(t.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},l.createElement(t.span,{className:"pstrut",style:{height:"2.7em"}}),l.createElement(t.span,{className:"sizing reset-size6 size3 mtight"},l.createElement(t.span,{className:"mord mtight"},l.createElement(t.span,{className:"mord mathnormal mtight"},"c"),l.createElement(t.span,{className:"mord mathnormal mtight"},"t"),l.createElement(t.span,{className:"mord mathnormal mtight"},"x"),l.createElement(t.span,{className:"mord mathnormal mtight"},"t"))))),l.createElement(t.span,{className:"vlist-s"},"​")),l.createElement(t.span,{className:"vlist-r"},l.createElement(t.span,{className:"vlist",style:{height:"0.15em"}},l.createElement(t.span)))))))))),"를 입력으로 사용하지 않을까요?"),l.createElement(t.p,null,"생각해보니 BlenderBot은 end-to-end 모델이 아닌 각 모듈들을 각자 다른 방식으로 fine-tuning을 진행하기 떄문에 그런듯.")),"\n",l.createElement(s.Z,null,l.createElement(t.p,null,"Retriever 모듈에서 context(input) - response(label) pair를 사용하여 학습을 진행하였는데\r\nDecoder 모듈에서도 context(input) - response(label) pair를 사용하는 것이 맞나?\r\n심지어 추론 단계에서 context - best candidate 를 토큰화한 입력을 이용하는데 이거 맞나?\r\n찾아보자고")),"\n",l.createElement(t.h2,{id:"retnrefretrieve-and-refine"},"RetNRef(Retrieve and Refine)"),"\n",l.createElement(t.p,null,"Generative model은 여전히 지루하고 반복적인 응답을 생성하는 문제가 있습니다.\r\n또 모델 파라미터에 embedding 되지 않은 지식에 대해서 접근하지 못하고, 이로 인해 거짓된 정보를 생성할 수 있죠.\r\n이러한 문제를 해결하기 위해 dialogue retrieval, knowledge retrieval 단계를 통해 조금 더 정제된 응답을 생성합니다."),"\n",l.createElement(t.h3,{id:"dialogue-retrieval"},"Dialogue retrieval"),"\n",l.createElement(t.p,null,"앞서 설명한 방식대로 데이터베이스에서 입력으로 들어온 대화 이력과 유사한 대화를 찾아 응답을 선택하는 방식을 사용합니다.\r\n이때 선택된 응답은 입력인 대화 이력과 특정 토큰으로 구분된 채 ",l.createElement(t.code,null,"Generator"),"의 입력으로 들어갑니다.\r\n",l.createElement(t.code,null,"Generator"),"가 검색된 응답의 요소를 사용할 지 안할지 선택하여 발화를 생성하도록 하여 조금 더 사람과 같은 대화를 할 수 있게 만드는 것이죠."),"\n",l.createElement(t.h3,{id:"knowledge-retrieval"},"Knowledge retrieval"),"\n",l.createElement(t.p,null,"위와 같은 방식을 지식 기반 대화에도 적용할 수 있습니다.\r\n먼저 현재 대화와 관련한 지식을 찾기 위해 Wikipedia를 TF-IDF 기반 검색을 통해 후보 문서셋을 찾습니다.\r\n이를 앞서 사용한 ",l.createElement(t.code,null,"Retriever"),"와 동일한 모델을 이용하여 순위를 매기고 단일 문장을 선택합니다.\r\n그리고 나서 같은 방식으로 ",l.createElement(t.code,null,"Generator"),"에 입력으로 넣어주어 적절한 발화를 생성하도록 하는 것이죠."),"\n",l.createElement(t.p,null,"하지만 모든 대화에 대해 검색을 시도하는 것은 좋은 방법이 아닙니다.\r\n그래서 현재 대화가 지식을 기반한 대화인지 분류하는 작업을 거치고, 필요하다 생각되면 검색을 진행하는 방식을 선택했어요."))}var r=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,m.ah)(),e.components);return t?l.createElement(t,e,l.createElement(n,e)):n(e)},c=a(4316),i=a(1840),p=a(7821),E=a(2654),o=a(4111),h=a(2726),g=a(4480),N=a(2818),u=a(9213),d=a(7213),y=a(9265),v=a(9601),x=a(3071),w=a(6097),b=a(6782),f=a(4891),z=a(3387),k=a(917);const R=e=>{let{data:{mdx:t},children:a}=e;const s=(0,g.sJ)((0,N.cp)(N.eE,!1)),n=(0,g.sJ)((0,N.cp)(N.rf,!1)),r=(0,g.Zl)((0,N.cp)(N.Cy,t.tableOfContents.items));return(0,l.useEffect)((()=>{r(t.tableOfContents.items)}),[t]),(0,k.tZ)(i.Z,null,(0,k.tZ)(A,null,(0,k.tZ)(o.Z,null)),(0,k.tZ)(M,null,(0,k.tZ)(Z,{className:"navigation",isNavOpened:n},(0,k.tZ)(L,{className:"hide_scroll"},(0,k.tZ)(p.Z,null))),(0,k.tZ)(D,{isNavOpened:n},(0,k.tZ)(j,{isWide:s},(0,k.tZ)(h.Z,{title:t.frontmatter.title,date:t.frontmatter.date}),(0,k.tZ)(m.Zo,{components:{p:d.Z,h1:y.H1,h2:y.H2,h3:y.H3,h4:y.H4,h5:y.H5,h6:y.H6,hr:v.Z,blockquote:x.Z,ul:b.Z,ol:w.Z,pre:f.Z,code:z.Z}},a))),(0,k.tZ)(B,null,(0,k.tZ)(I,null,(0,k.tZ)(E.Z,null)))))},A=(0,c.Z)("div",{target:"e1ojob7j7"})({name:"11t2x7x",styles:"display:flex;height:var(--header-height);z-index:5;padding:0.6rem 2rem 0.6rem 0.6rem;position:fixed;width:100%;background:var(--background-color);border-bottom:1px solid var(--border-color)"}),M=(0,c.Z)("div",{target:"e1ojob7j6"})({name:"majwgz",styles:"position:relative;display:flex;min-height:calc(100vh - var(--header-height));overflow-x:hidden"}),Z=(0,c.Z)("aside",{target:"e1ojob7j5"})("margin-left:",(e=>e.isNavOpened?"0":"calc(-1 * var(--sidebar-width))"),";flex:0 0 var(--sidebar-width);font-size:0.875rem;overflow-x:hidden;overflow-y:auto;transition:margin 0.25s var(--ease-in-out-quad);@media (min-width: ",u.Z.IPAD_PRO,"px){margin-left:0;}"),L=(0,c.Z)("nav",{target:"e1ojob7j4"})({name:"l4vzaw",styles:"overflow-y:auto;height:100%;padding:var(--body-padding-top) 0 3rem 0;position:fixed;width:var(--sidebar-width);&:-webkit-scrollbar{display:none;}"}),j=(0,c.Z)("main",{target:"e1ojob7j3"})("padding:1rem;width:100%;@media (min-width: ",u.Z.IPAD_AIR,"px){width:",(e=>e.isWide?"90%":"65%"),";}"),D=(0,c.Z)("main",{target:"e1ojob7j2"})("width:calc(100% - 2 * var(--sidebar-width));padding-top:var(--body-padding-top);flex-grow:1;min-width:20rem;display:flex;justify-content:center;opacity:",(e=>e.isNavOpened?.3:1),";@media (min-width: ",u.Z.IPAD_PRO,"px){opacity:1;}"),B=(0,c.Z)("aside",{target:"e1ojob7j1"})("font-size:0.75rem;font-weight:bold;overflow-x:hidden;overflow-y:auto;padding-top:var(--body-padding-top);width:0;transition:width 0.25s var(--ease-in-out-quad);@media (min-width: ",u.Z.HD,"px){width:var(--sidebar-width);}"),I=(0,c.Z)(L,{target:"e1ojob7j0"})({name:"b40oxt",styles:"padding:0 1rem 0 1rem"});function C(e){return l.createElement(R,e,l.createElement(r,e))}}}]);
//# sourceMappingURL=component---src-components-templates-main-template-tsx-content-file-path-contents-paper-open-domain-chatbot-blenderbot-v-1-mdx-d94ea9eee2d2baa04200.js.map